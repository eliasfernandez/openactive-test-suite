[< Return to Summary](summary.md) | File Generated: Fri Jul 22 2022 10:43:16 GMT+0000 (Coordinated Universal Time)

# free-opportunities >> opportunity-free-without-checkpoints (OpenBookingApprovalFlow >> ScheduledSession)

**Booking Flow:** OpenBookingApprovalFlow

**Opportunity Type:** ScheduledSession

**Feature:** Payment / Free opportunities (Implemented) 

**Test:**  Successful booking without Checkpoints

Free Opportunities, as they need no tax calculation by the Booking System, and, if they do not require additional details, should be bookable without using Checkpoints C1 & C2

### Running only this test

```bash
npm start -- --runInBand test/features/payment/free-opportunities/implemented/opportunity-free-without-checkpoints-test.js
```

---

âš ï¸ 9 passed with 0 failures, 102 warnings and 34 suggestions 

---


## Fetch Opportunities

### Booking System Test Interface for OrderItem 0 Request
POST https://localhost:5001/api/openbooking/test-interface/datasets/uat-ci/opportunities

* **Content-Type:** `"application/vnd.openactive.booking+json; version=1"`
* **Authorization:** `"Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE2NTg0ODU2NTAsImV4cCI6MTY1ODQ4OTI1MCwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0IiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0Iiwic3ViIjoiMTAwIiwiYXV0aF90aW1lIjoxNjU4NDg1NjQ5LCJpZHAiOiJsb2NhbCIsImh0dHBzOi8vb3BlbmFjdGl2ZS5pby9zZWxsZXJJZCI6Imh0dHBzOi8vbG9jYWxob3N0OjUwMDEvYXBpL2lkZW50aWZpZXJzL3NlbGxlcnMvMSIsImp0aSI6IkZFNjE5OTM5Q0M2MUVFRTFDQTFDRUIyNzczMTYyMjg5Iiwic2lkIjoiMEI1RjVGRDEzODJGNTY2REE2NzI2RUM1RjBENjRFQ0QiLCJpYXQiOjE2NTg0ODU2NTAsInNjb3BlIjpbIm9wZW5pZCIsIm9wZW5hY3RpdmUtb3BlbmJvb2tpbmciLCJvcGVuYWN0aXZlLWlkZW50aXR5Iiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbInB3ZCJdfQ.o-QctzkQMggVF6J8EIsjxJ43llGhs2jSEGiCfZxoPJjg0Coj1XkqaKd5Bltzc2D21dEBtbq-c5sKreCqebPhxuDlg_pDikudK9_wCosxWyOPIBS3OX6HFWM-J-Ofpxgkk5thfLTkLlDW8N6f3jtsTIRGm9dZvKsGypmwxnDdRhGKwxSDhnabWbPtFCABWC6DxK5mgb6V5SX3W3QxbI181T1tQioKui-N8j1FSgIpXrE3qy2ShkI-QbxwmMBCYhqcTbhLi41SUSx6gKgtl54lc_JEx-kSBlgsQmOrRKMDDrEecM9JQMNAliL2mJeIClUfC8k_SUKbJ8VvbNBbMjVSCw"`

```json
{
  "@type": "ScheduledSession",
  "superEvent": {
    "@type": "SessionSeries",
    "organizer": {
      "@type": "Organization",
      "@id": "https://localhost:5001/api/identifiers/sellers/1"
    }
  },
  "@context": [
    "https://openactive.io/",
    "https://openactive.io/test-interface"
  ],
  "test:testOpportunityCriteria": "https://openactive.io/test-interface#TestOpportunityBookableFree",
  "test:testOpenBookingFlow": "https://openactive.io/test-interface#OpenBookingApprovalFlow",
  "test:testOpportunityDataShapeExpression": [
    {
      "@type": "test:TripleConstraint",
      "predicate": "https://schema.org/remainingAttendeeCapacity",
      "valueExpr": {
        "@type": "NumericNodeConstraint",
        "mininclusive": 2
      }
    },
    {
      "@type": "test:TripleConstraint",
      "predicate": "https://openactive.io/isOpenBookingAllowed",
      "valueExpr": {
        "@type": "test:BooleanNodeConstraint",
        "value": true
      }
    },
    {
      "@type": "test:TripleConstraint",
      "predicate": "https://schema.org/startDate",
      "valueExpr": {
        "@type": "test:DateRangeNodeConstraint",
        "minDate": "2022-07-22T12:27:25.573+00:00"
      }
    },
    {
      "@type": "test:TripleConstraint",
      "predicate": "https://schema.org/eventStatus",
      "valueExpr": {
        "@type": "test:OptionNodeConstraint",
        "datatype": "schema:EventStatusType",
        "blocklist": [
          "https://schema.org/EventCancelled",
          "https://schema.org/EventPostponed"
        ]
      }
    }
  ],
  "test:testOfferDataShapeExpression": [
    {
      "@type": "test:TripleConstraint",
      "predicate": "https://openactive.io/openBookingFlowRequirement",
      "valueExpr": {
        "@type": "test:ArrayConstraint",
        "datatype": "oa:OpenBookingFlowRequirement",
        "includesAll": [
          "https://openactive.io/OpenBookingApproval"
        ],
        "excludesAll": [
          "https://openactive.io/OpenBookingAttendeeDetails",
          "https://openactive.io/OpenBookingIntakeForm"
        ]
      }
    },
    {
      "@type": "test:TripleConstraint",
      "predicate": "https://schema.org/price",
      "valueExpr": {
        "@type": "NumericNodeConstraint",
        "maxinclusive": 0
      }
    },
    {
      "@type": "test:TripleConstraint",
      "predicate": "https://openactive.io/openBookingPrepayment",
      "valueExpr": {
        "@type": "test:OptionNodeConstraint",
        "datatype": "oa:RequiredStatusType",
        "allowlist": [
          "https://openactive.io/Unavailable"
        ],
        "allowNull": true
      }
    },
    {
      "@type": "test:TripleConstraint",
      "predicate": "https://openactive.io/validFromBeforeStartDate",
      "valueExpr": {
        "@type": "test:DateRangeNodeConstraint",
        "maxDate": "2022-07-22T10:27:25.573+00:00",
        "allowNull": true
      }
    },
    {
      "@type": "test:TripleConstraint",
      "predicate": "https://openactive.io/openBookingInAdvance",
      "valueExpr": {
        "@type": "test:OptionNodeConstraint",
        "datatype": "oa:RequiredStatusType",
        "blocklist": [
          "https://openactive.io/Unavailable"
        ]
      }
    }
  ]
}
```

---
Response status code: 200 OK. Responded in 18.638664ms.
```json
{
  "@context": "https://openactive.io/",
  "@type": "ScheduledSession",
  "@id": "https://localhost:5001/api/identifiers/scheduled-sessions/2408/events/20408"
}
```

### Opportunity Feed extract for OrderItem 0 Request
GET http://localhost:3000/opportunity/https%3A%2F%2Flocalhost%3A5001%2Fapi%2Fidentifiers%2Fscheduled-sessions%2F2408%2Fevents%2F20408?useCacheIfAvailable=true


---
Response status code: 200 OK. Responded in 405.121456ms.
```json
{
  "state": "updated",
  "id": "https://localhost:5001/api/identifiers/scheduled-sessions/2408/events/20408",
  "modified": 1658486615916,
  "data": {
    "@context": [
      "https://openactive.io/"
    ],
    "@type": "ScheduledSession",
    "@id": "https://localhost:5001/api/identifiers/scheduled-sessions/2408/events/20408",
    "startDate": "2022-07-23T10:43:34+00:00",
    "endDate": "2022-07-23T11:43:34+00:00",
    "superEvent": {
      "@type": "SessionSeries",
      "@id": "https://localhost:5001/api/identifiers/session-series/2408",
      "name": "[OPEN BOOKING API TEST INTERFACE] Bookable Free Event",
      "activity": [
        {
          "@type": "Concept",
          "@id": "https://openactive.io/activity-list#c07d63a0-8eb9-4602-8bcc-23be6deb8f83",
          "inScheme": "https://openactive.io/activity-list",
          "prefLabel": "Jet Skiing"
        }
      ],
      "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
      "location": {
        "@type": "Place",
        "name": "Fake Pond",
        "address": {
          "@type": "PostalAddress",
          "addressCountry": "GB",
          "addressLocality": "Another town",
          "addressRegion": "Oxfordshire",
          "postalCode": "OX1 1AA",
          "streetAddress": "1 Fake Park"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": 0.1,
          "longitude": 0.1
        }
      },
      "offers": [
        {
          "@type": "Offer",
          "@id": "https://localhost:5001/api/identifiers/session-series/2408#/offers/0",
          "allowCustomerCancellationFullRefund": true,
          "openBookingFlowRequirement": [
            "https://openactive.io/OpenBookingApproval"
          ],
          "price": 0,
          "priceCurrency": "GBP"
        }
      ],
      "organizer": {
        "@type": "Organization",
        "@id": "https://localhost:5001/api/identifiers/sellers/1",
        "name": "Acme Fitness Ltd",
        "isOpenBookingAllowed": true,
        "taxMode": "https://openactive.io/TaxGross",
        "termsOfService": [
          {
            "@type": "PrivacyPolicy",
            "name": "Privacy Policy",
            "requiresExplicitConsent": false,
            "url": "https://example.com/privacy.html"
          }
        ]
      },
      "url": "https://www.example.com/a-session-age"
    },
    "duration": "PT1H",
    "maximumAttendeeCapacity": 10,
    "remainingAttendeeCapacity": 10
  }
}
```
### Specs
* âœ… should return 200 on success for request relevant to OrderItem 0

## Fetch Opportunities >> validation of Opportunity Feed extract for OrderItem 0
### Specs
* âœ… passes validation checks
* âœ… matches the criteria 'TestOpportunityBookableFree' required for this test

### Validations
 * âš ï¸ $.eventStatus: Recommended property `eventStatus` is missing from `ScheduledSession`.
 * âš ï¸ $.leader: Recommended property `leader` is missing from `ScheduledSession`.
 * âš ï¸ $.url: Recommended property `url` is missing from `ScheduledSession`.
 * âš ï¸ $.isAccessibleForFree: Where a `ScheduledSession` has at least one `Offer` with `price` set to `0`, it should also have a property named `isAccessibleForFree` set to `true`.
 * âš ï¸ $.superEvent.description: Recommended property `description` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.image: Recommended property `image` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.ageRange: Recommended property `ageRange` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.genderRestriction: Recommended property `genderRestriction` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.leader: Recommended property `leader` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.level: Recommended property `level` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.isAccessibleForFree: Where a `SessionSeries` has at least one `Offer` with `price` set to `0`, it should also have a property named `isAccessibleForFree` set to `true`.
 * âš ï¸ $.superEvent.location.id: Recommended property `@id` is missing from `Place`.
 * âš ï¸ $.superEvent.location.url: Recommended property `url` is missing from `Place`.
 * âš ï¸ $.superEvent.location.description: Recommended property `description` is missing from `Place`.
 * âš ï¸ $.superEvent.location.image: Recommended property `image` is missing from `Place`.
 * âš ï¸ $.superEvent.location.telephone: Recommended property `telephone` is missing from `Place`.
 * âš ï¸ $.superEvent.location.openingHoursSpecification: Recommended property `openingHoursSpecification` is missing from `Place`.
 * âš ï¸ $.superEvent.location.amenityFeature: Recommended property `amenityFeature` is missing from `Place`.
 * âš ï¸ $.superEvent.offers[0].name: Recommended property `name` is missing from `Offer`.
 * âš ï¸ $.superEvent.offers[0].ageRestriction: Recommended property `ageRestriction` is missing from `Offer`.
 * âš ï¸ $.superEvent.organizer.url: Recommended property `url` is missing from `Organization`.
 * âš ï¸ $.superEvent.organizer.telephone: Recommended property `telephone` is missing from `Organization`.
 * âš ï¸ $.superEvent.organizer.sameAs: Recommended property `sameAs` is missing from `Organization`.
 * ðŸ“ $.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `ScheduledSession`.
 * ðŸ“ $.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.
 * ðŸ“ $.superEvent.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `SessionSeries`.
 * ðŸ“ $.superEvent.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.superEvent.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.
 * ðŸ“ $.superEvent.location.geo.latitude: The value of this property should have at least 3 decimal places. Note that this notice will also appear when trailing zeros have been truncated.
 * ðŸ“ $.superEvent.location.geo.longitude: The value of this property should have at least 3 decimal places. Note that this notice will also appear when trailing zeros have been truncated.

## P

### P Request
PUT https://localhost:5001/api/openbooking/order-proposals/ebd87359-8e25-41db-9895-639a04052db2

* **Content-Type:** `"application/vnd.openactive.booking+json; version=1"`
* **Authorization:** `"Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE2NTg0ODU2NTAsImV4cCI6MTY1ODQ4OTI1MCwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0IiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0Iiwic3ViIjoiMTAwIiwiYXV0aF90aW1lIjoxNjU4NDg1NjQ5LCJpZHAiOiJsb2NhbCIsImh0dHBzOi8vb3BlbmFjdGl2ZS5pby9zZWxsZXJJZCI6Imh0dHBzOi8vbG9jYWxob3N0OjUwMDEvYXBpL2lkZW50aWZpZXJzL3NlbGxlcnMvMSIsImp0aSI6IkZFNjE5OTM5Q0M2MUVFRTFDQTFDRUIyNzczMTYyMjg5Iiwic2lkIjoiMEI1RjVGRDEzODJGNTY2REE2NzI2RUM1RjBENjRFQ0QiLCJpYXQiOjE2NTg0ODU2NTAsInNjb3BlIjpbIm9wZW5pZCIsIm9wZW5hY3RpdmUtb3BlbmJvb2tpbmciLCJvcGVuYWN0aXZlLWlkZW50aXR5Iiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbInB3ZCJdfQ.o-QctzkQMggVF6J8EIsjxJ43llGhs2jSEGiCfZxoPJjg0Coj1XkqaKd5Bltzc2D21dEBtbq-c5sKreCqebPhxuDlg_pDikudK9_wCosxWyOPIBS3OX6HFWM-J-Ofpxgkk5thfLTkLlDW8N6f3jtsTIRGm9dZvKsGypmwxnDdRhGKwxSDhnabWbPtFCABWC6DxK5mgb6V5SX3W3QxbI181T1tQioKui-N8j1FSgIpXrE3qy2ShkI-QbxwmMBCYhqcTbhLi41SUSx6gKgtl54lc_JEx-kSBlgsQmOrRKMDDrEecM9JQMNAliL2mJeIClUfC8k_SUKbJ8VvbNBbMjVSCw"`

```json
{
  "@context": "https://openactive.io/",
  "@type": "OrderProposal",
  "brokerRole": "https://openactive.io/AgentBroker",
  "broker": {
    "@type": "Organization",
    "name": "MyFitnessApp",
    "url": "https://myfitnessapp.example.com",
    "description": "A fitness app for all the community",
    "logo": {
      "@type": "ImageObject",
      "url": "http://data.myfitnessapp.org.uk/images/logo.png"
    },
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Alan Peacock Way",
      "addressLocality": "Village East",
      "addressRegion": "Middlesbrough",
      "postalCode": "TS4 3AE",
      "addressCountry": "GB"
    }
  },
  "seller": "https://localhost:5001/api/identifiers/sellers/1",
  "customer": {
    "@type": "Person",
    "email": "Gillian_Glover60@hotmail.com",
    "telephone": "1-927-812-0052",
    "givenName": "Huels",
    "familyName": "Juliana",
    "identifier": "fea89cd8-81f1-434b-b0e9-5a6d3486a96f"
  },
  "orderedItem": [
    {
      "@type": "OrderItem",
      "position": 0,
      "acceptedOffer": "https://localhost:5001/api/identifiers/session-series/2408#/offers/0",
      "orderedItem": "https://localhost:5001/api/identifiers/scheduled-sessions/2408/events/20408"
    }
  ],
  "totalPaymentDue": {
    "@type": "PriceSpecification",
    "price": 0,
    "priceCurrency": "GBP"
  }
}
```

---
Response status code: 201 Created. Responded in 337.835074ms.
```json
{
  "@context": "https://openactive.io/",
  "@type": "OrderProposal",
  "@id": "https://localhost:5001/api/openbooking/order-proposals/ebd87359-8e25-41db-9895-639a04052db2",
  "orderProposalStatus": "https://openactive.io/AwaitingSellerConfirmation",
  "bookingService": {
    "@type": "BookingService",
    "name": "Acme booking system",
    "termsOfService": [
      {
        "@type": "PrivacyPolicy",
        "name": "Privacy Policy",
        "requiresExplicitConsent": false,
        "url": "https://example.com/privacy.html"
      }
    ],
    "url": "https://example.com"
  },
  "broker": {
    "@type": "Organization",
    "name": "MyFitnessApp",
    "url": "https://myfitnessapp.example.com"
  },
  "brokerRole": "https://openactive.io/AgentBroker",
  "customer": {
    "@type": "Person",
    "identifier": "fea89cd8-81f1-434b-b0e9-5a6d3486a96f",
    "email": "Gillian_Glover60@hotmail.com",
    "familyName": "Juliana",
    "givenName": "Huels",
    "telephone": "1-927-812-0052"
  },
  "orderedItem": [
    {
      "@type": "OrderItem",
      "@id": "https://localhost:5001/api/openbooking/orders/ebd87359-8e25-41db-9895-639a04052db2#/orderedItems/2024",
      "acceptedOffer": {
        "@type": "Offer",
        "@id": "https://localhost:5001/api/identifiers/session-series/2408#/offers/0",
        "allowCustomerCancellationFullRefund": true,
        "price": 0,
        "priceCurrency": "GBP"
      },
      "orderedItem": {
        "@type": "ScheduledSession",
        "@id": "https://localhost:5001/api/identifiers/scheduled-sessions/2408/events/20408",
        "startDate": "2022-07-23T10:43:34+00:00",
        "endDate": "2022-07-23T11:43:34+00:00",
        "superEvent": {
          "@type": "SessionSeries",
          "@id": "https://localhost:5001/api/identifiers/session-series/2408",
          "name": "[OPEN BOOKING API TEST INTERFACE] Bookable Free Event",
          "activity": [
            {
              "@type": "Concept",
              "@id": "https://openactive.io/activity-list#6bdea630-ad22-4e58-98a3-bca26ee3f1da",
              "inScheme": "https://openactive.io/activity-list",
              "prefLabel": "Rave Fitness"
            }
          ],
          "location": {
            "@type": "Place",
            "name": "Fake fitness studio",
            "geo": {
              "@type": "GeoCoordinates",
              "latitude": 51.6201,
              "longitude": 0.302396
            }
          },
          "url": "https://example.com/events/2408"
        },
        "maximumAttendeeCapacity": 10,
        "remainingAttendeeCapacity": 10
      },
      "position": 0,
      "unitTaxSpecification": [
        {
          "@type": "TaxChargeSpecification",
          "name": "VAT at 20%",
          "price": 0,
          "priceCurrency": "GBP",
          "rate": 0.2
        }
      ]
    }
  ],
  "orderProposalVersion": "https://localhost:5001/api/openbooking/order-proposals/ebd87359-8e25-41db-9895-639a04052db2/versions/d3c74563-d468-4fcf-ba73-f3b737adebe3",
  "seller": {
    "@type": "Organization",
    "@id": "https://localhost:5001/api/identifiers/sellers/1",
    "name": "Acme Fitness Ltd",
    "address": {
      "@type": "PostalAddress",
      "addressCountry": "GB",
      "addressLocality": "Another town",
      "addressRegion": "Oxfordshire",
      "postalCode": "OX1 1AA",
      "streetAddress": "1 Hidden Gem"
    },
    "isOpenBookingAllowed": true,
    "legalName": "Acme Fitness Ltd",
    "taxMode": "https://openactive.io/TaxGross",
    "termsOfService": [
      {
        "@type": "PrivacyPolicy",
        "name": "Privacy Policy",
        "requiresExplicitConsent": false,
        "url": "https://example.com/privacy.html"
      }
    ]
  },
  "totalPaymentDue": {
    "@type": "PriceSpecification",
    "openBookingPrepayment": "https://openactive.io/Unavailable",
    "price": 0,
    "priceCurrency": "GBP"
  },
  "totalPaymentTax": [
    {
      "@type": "TaxChargeSpecification",
      "name": "VAT at 20%",
      "price": 0,
      "priceCurrency": "GBP",
      "rate": 0.2
    }
  ]
}
```
### Specs
* âœ… should return 201 on success

## P >> validation of P
### Specs
* âœ… passes validation checks

### Validations
 * âš ï¸ $.orderedItem[0].acceptedOffer.name: Recommended property `name` is missing from `Offer`.
 * âš ï¸ $.orderedItem[0].acceptedOffer.ageRestriction: Recommended property `ageRestriction` is missing from `Offer`.
 * âš ï¸ $.orderedItem[0].orderedItem.eventStatus: Recommended property `eventStatus` is missing from `ScheduledSession`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.ageRange: Recommended property `ageRange` is missing from `SessionSeries`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.genderRestriction: Recommended property `genderRestriction` is missing from `SessionSeries`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.eventStatus: Recommended property `eventStatus` is missing from `SessionSeries`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.id: Recommended property `@id` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.url: Recommended property `url` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.description: Recommended property `description` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.image: Recommended property `image` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.telephone: Recommended property `telephone` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.openingHoursSpecification: Recommended property `openingHoursSpecification` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.amenityFeature: Recommended property `amenityFeature` is missing from `Place`.
 * âš ï¸ $.seller.email: Recommended property `email` is missing from `Organization`.
 * âš ï¸ $.seller.url: Recommended property `url` is missing from `Organization`.
 * âš ï¸ $.seller.logo: Recommended property `logo` is missing from `Organization`.
 * âš ï¸ $.seller.vatID: Recommended property `vatID` is missing from `Organization`.
 * ðŸ“ $.orderedItem[0].orderedItem.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `ScheduledSession`.
 * ðŸ“ $.orderedItem[0].orderedItem.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.orderedItem[0].orderedItem.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.
 * ðŸ“ $.orderedItem[0].orderedItem.superEvent.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `SessionSeries`.
 * ðŸ“ $.orderedItem[0].orderedItem.superEvent.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.orderedItem[0].orderedItem.superEvent.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.

## Simulate Seller Approval (Test Interface Action)

### Orders (order-proposals) Feed listen for &#x27;ebd87359-8e25-41db-9895-639a04052db2&#x27; change (auth: primary) Request
POST http://localhost:3000/order-listeners/order-proposals/primary/ebd87359-8e25-41db-9895-639a04052db2


---
Response status code: 200 OK. Responded in 12.391309ms.
```json
{
  "headers": {
    "Accept": "application/json, application/vnd.openactive.booking+json; version=1",
    "Cache-Control": "max-age=0",
    "Authorization": "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE2NTg0ODU2NDcsImV4cCI6MTY1ODQ4OTI0NywiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0IiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0IiwianRpIjoiMUZFM0JGRjA5NzM2MkFGNTA3MUU0N0YyQzlCNTVCRUEiLCJpYXQiOjE2NTg0ODU2NDcsInNjb3BlIjpbIm9wZW5hY3RpdmUtb3JkZXJzZmVlZCJdfQ.ZtHhIzQ44JG7A3_CrrYLgAvlf08ifJ0Oyl9S2EI8XJWrWsObnEwOASFyLkEsd-e2Dfo35P03h5hmv3bte4jMohA6o6DGxAX1Pu3jQUt1Pkw7gcwjjT3TilXnNXqjo9sV9GnZtkzSrfnQgvALDkP777pyu5AApxluaGVYEiFWhou4YCG43w1815qW-0xrKd8NX8iVsNkGndYT38mL13looa9pjveSd57bISQmDxJS3WcNyX86O0P5870kiQbaP_uYz_vxYGoyMkaKl2sfS6vdGvkVBc7gPmIRylBsGja1O31fI7Y4ofjCoOyjMhqgT1Xxw1GlmqoBTrM2nMGdiVRb7w"
  },
  "startingFeedPage": "https://localhost:5001/api/openbooking/order-proposals-rpde?afterTimestamp=637940834043368454&afterId=7a4689bc-e4a3-4e37-abd3-1f53673000cc",
  "message": "Listening for UUID: 'ebd87359-8e25-41db-9895-639a04052db2' in feed: order-proposals, for Booking Partner: primary from startingFeedPage using headers"
}
```

### Call TestInterface Action of type: test:SellerAcceptOrderProposalSimulateAction Request
POST https://localhost:5001/api/openbooking/test-interface/actions

* **Content-Type:** `"application/vnd.openactive.booking+json; version=1"`
* **Authorization:** `"Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE2NTg0ODU2NTAsImV4cCI6MTY1ODQ4OTI1MCwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0IiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0Iiwic3ViIjoiMTAwIiwiYXV0aF90aW1lIjoxNjU4NDg1NjQ5LCJpZHAiOiJsb2NhbCIsImh0dHBzOi8vb3BlbmFjdGl2ZS5pby9zZWxsZXJJZCI6Imh0dHBzOi8vbG9jYWxob3N0OjUwMDEvYXBpL2lkZW50aWZpZXJzL3NlbGxlcnMvMSIsImp0aSI6IkZFNjE5OTM5Q0M2MUVFRTFDQTFDRUIyNzczMTYyMjg5Iiwic2lkIjoiMEI1RjVGRDEzODJGNTY2REE2NzI2RUM1RjBENjRFQ0QiLCJpYXQiOjE2NTg0ODU2NTAsInNjb3BlIjpbIm9wZW5pZCIsIm9wZW5hY3RpdmUtb3BlbmJvb2tpbmciLCJvcGVuYWN0aXZlLWlkZW50aXR5Iiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbInB3ZCJdfQ.o-QctzkQMggVF6J8EIsjxJ43llGhs2jSEGiCfZxoPJjg0Coj1XkqaKd5Bltzc2D21dEBtbq-c5sKreCqebPhxuDlg_pDikudK9_wCosxWyOPIBS3OX6HFWM-J-Ofpxgkk5thfLTkLlDW8N6f3jtsTIRGm9dZvKsGypmwxnDdRhGKwxSDhnabWbPtFCABWC6DxK5mgb6V5SX3W3QxbI181T1tQioKui-N8j1FSgIpXrE3qy2ShkI-QbxwmMBCYhqcTbhLi41SUSx6gKgtl54lc_JEx-kSBlgsQmOrRKMDDrEecM9JQMNAliL2mJeIClUfC8k_SUKbJ8VvbNBbMjVSCw"`

```json
{
  "@context": [
    "https://openactive.io/",
    "https://openactive.io/test-interface"
  ],
  "@type": "test:SellerAcceptOrderProposalSimulateAction",
  "object": {
    "@type": "OrderProposal",
    "@id": "https://localhost:5001/api/openbooking/order-proposals/ebd87359-8e25-41db-9895-639a04052db2"
  }
}
```

---
Response status code: 204 No Content. Responded in 19.182569ms.
### Specs
* âœ… should return 204 on success

## OrderProposal Feed Update (after Simulate Seller Approval)

### Orders (order-proposals) Feed collect for &#x27;ebd87359-8e25-41db-9895-639a04052db2&#x27; change (auth: primary) Request
GET http://localhost:3000/order-listeners/order-proposals/primary/ebd87359-8e25-41db-9895-639a04052db2


---
Response status code: 200 OK. Responded in 2356.558295ms.
```json
{
  "state": "updated",
  "kind": "Order",
  "id": "ebd87359-8e25-41db-9895-639a04052db2",
  "modified": 637940834155708800,
  "data": {
    "@context": "https://openactive.io/",
    "@type": "OrderProposal",
    "@id": "https://localhost:5001/api/openbooking/order-proposals/ebd87359-8e25-41db-9895-639a04052db2",
    "identifier": "ebd87359-8e25-41db-9895-639a04052db2",
    "orderProposalStatus": "https://openactive.io/SellerAccepted",
    "orderedItem": [
      {
        "@type": "OrderItem",
        "@id": "https://localhost:5001/api/openbooking/orders/ebd87359-8e25-41db-9895-639a04052db2#/orderedItems/2024",
        "acceptedOffer": {
          "@type": "Offer",
          "@id": "https://localhost:5001/api/identifiers/session-series/2408#/offers/0",
          "price": 0,
          "priceCurrency": "GBP"
        },
        "orderedItem": "https://localhost:5001/api/identifiers/scheduled-sessions/2408/events/20408"
      }
    ],
    "orderProposalVersion": "https://localhost:5001/api/openbooking/order-proposals/ebd87359-8e25-41db-9895-639a04052db2/versions/d3c74563-d468-4fcf-ba73-f3b737adebe3",
    "totalPaymentDue": {
      "@type": "PriceSpecification",
      "openBookingPrepayment": "https://openactive.io/Unavailable",
      "price": 0,
      "priceCurrency": "GBP"
    }
  }
}
```
### Specs
* âœ… should return 200 on success

## OrderProposal Feed Update (after Simulate Seller Approval) >> validation of OrderFeed
### Specs
* âœ… passes validation checks

### Validations
 * âš ï¸ $.orderedItem[0].acceptedOffer.name: Recommended property `name` is missing from `Offer`.
 * âš ï¸ $.orderedItem[0].acceptedOffer.ageRestriction: Recommended property `ageRestriction` is missing from `Offer`.
 * âš ï¸ $.orderedItem[0].acceptedOffer.allowCustomerCancellationFullRefund: Recommended property `allowCustomerCancellationFullRefund` is missing from `Offer`.

## B

### Orders (order-proposals) Feed listen for &#x27;ebd87359-8e25-41db-9895-639a04052db2&#x27; change (auth: primary) Request
POST http://localhost:3000/order-listeners/order-proposals/primary/ebd87359-8e25-41db-9895-639a04052db2


---
Response status code: 200 OK. Responded in 20.005577ms.
```json
{
  "headers": {
    "Accept": "application/json, application/vnd.openactive.booking+json; version=1",
    "Cache-Control": "max-age=0",
    "Authorization": "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE2NTg0ODU2NDcsImV4cCI6MTY1ODQ4OTI0NywiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0IiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0IiwianRpIjoiMUZFM0JGRjA5NzM2MkFGNTA3MUU0N0YyQzlCNTVCRUEiLCJpYXQiOjE2NTg0ODU2NDcsInNjb3BlIjpbIm9wZW5hY3RpdmUtb3JkZXJzZmVlZCJdfQ.ZtHhIzQ44JG7A3_CrrYLgAvlf08ifJ0Oyl9S2EI8XJWrWsObnEwOASFyLkEsd-e2Dfo35P03h5hmv3bte4jMohA6o6DGxAX1Pu3jQUt1Pkw7gcwjjT3TilXnNXqjo9sV9GnZtkzSrfnQgvALDkP777pyu5AApxluaGVYEiFWhou4YCG43w1815qW-0xrKd8NX8iVsNkGndYT38mL13looa9pjveSd57bISQmDxJS3WcNyX86O0P5870kiQbaP_uYz_vxYGoyMkaKl2sfS6vdGvkVBc7gPmIRylBsGja1O31fI7Y4ofjCoOyjMhqgT1Xxw1GlmqoBTrM2nMGdiVRb7w"
  },
  "startingFeedPage": "https://localhost:5001/api/openbooking/order-proposals-rpde?afterTimestamp=637940834155708770&afterId=ebd87359-8e25-41db-9895-639a04052db2",
  "message": "Listening for UUID: 'ebd87359-8e25-41db-9895-639a04052db2' in feed: order-proposals, for Booking Partner: primary from startingFeedPage using headers"
}
```

### B Request
PUT https://localhost:5001/api/openbooking/orders/ebd87359-8e25-41db-9895-639a04052db2

* **Content-Type:** `"application/vnd.openactive.booking+json; version=1"`
* **Authorization:** `"Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE2NTg0ODU2NTAsImV4cCI6MTY1ODQ4OTI1MCwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0IiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0Iiwic3ViIjoiMTAwIiwiYXV0aF90aW1lIjoxNjU4NDg1NjQ5LCJpZHAiOiJsb2NhbCIsImh0dHBzOi8vb3BlbmFjdGl2ZS5pby9zZWxsZXJJZCI6Imh0dHBzOi8vbG9jYWxob3N0OjUwMDEvYXBpL2lkZW50aWZpZXJzL3NlbGxlcnMvMSIsImp0aSI6IkZFNjE5OTM5Q0M2MUVFRTFDQTFDRUIyNzczMTYyMjg5Iiwic2lkIjoiMEI1RjVGRDEzODJGNTY2REE2NzI2RUM1RjBENjRFQ0QiLCJpYXQiOjE2NTg0ODU2NTAsInNjb3BlIjpbIm9wZW5pZCIsIm9wZW5hY3RpdmUtb3BlbmJvb2tpbmciLCJvcGVuYWN0aXZlLWlkZW50aXR5Iiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbInB3ZCJdfQ.o-QctzkQMggVF6J8EIsjxJ43llGhs2jSEGiCfZxoPJjg0Coj1XkqaKd5Bltzc2D21dEBtbq-c5sKreCqebPhxuDlg_pDikudK9_wCosxWyOPIBS3OX6HFWM-J-Ofpxgkk5thfLTkLlDW8N6f3jtsTIRGm9dZvKsGypmwxnDdRhGKwxSDhnabWbPtFCABWC6DxK5mgb6V5SX3W3QxbI181T1tQioKui-N8j1FSgIpXrE3qy2ShkI-QbxwmMBCYhqcTbhLi41SUSx6gKgtl54lc_JEx-kSBlgsQmOrRKMDDrEecM9JQMNAliL2mJeIClUfC8k_SUKbJ8VvbNBbMjVSCw"`

```json
{
  "@context": "https://openactive.io/",
  "@type": "Order",
  "orderProposalVersion": "https://localhost:5001/api/openbooking/order-proposals/ebd87359-8e25-41db-9895-639a04052db2/versions/d3c74563-d468-4fcf-ba73-f3b737adebe3"
}
```

---
Response status code: 201 Created. Responded in 120.309561ms.
```json
{
  "@context": [
    "https://openactive.io/",
    "https://openactive.io/ns-beta"
  ],
  "@type": "Order",
  "@id": "https://localhost:5001/api/openbooking/orders/ebd87359-8e25-41db-9895-639a04052db2",
  "identifier": "ebd87359-8e25-41db-9895-639a04052db2",
  "bookingService": {
    "@type": "BookingService",
    "name": "Acme booking system",
    "termsOfService": [
      {
        "@type": "PrivacyPolicy",
        "name": "Privacy Policy",
        "requiresExplicitConsent": false,
        "url": "https://example.com/privacy.html"
      }
    ],
    "url": "https://example.com"
  },
  "broker": {
    "@type": "Organization",
    "name": "MyFitnessApp",
    "url": "https://myfitnessapp.example.com/"
  },
  "brokerRole": "https://openactive.io/AgentBroker",
  "customer": {
    "@type": "Person",
    "identifier": "fea89cd8-81f1-434b-b0e9-5a6d3486a96f",
    "email": "Gillian_Glover60@hotmail.com",
    "familyName": "Juliana",
    "givenName": "Huels",
    "telephone": "1-927-812-0052"
  },
  "orderedItem": [
    {
      "@type": "OrderItem",
      "@id": "https://localhost:5001/api/openbooking/orders/ebd87359-8e25-41db-9895-639a04052db2#/orderedItems/2024",
      "acceptedOffer": {
        "@type": "Offer",
        "@id": "https://localhost:5001/api/identifiers/session-series/2408#/offers/0",
        "allowCustomerCancellationFullRefund": true,
        "price": 0,
        "priceCurrency": "GBP"
      },
      "accessCode": [
        {
          "@type": "PropertyValue",
          "name": "Pin Code",
          "description": "027058",
          "value": "defaultValue"
        }
      ],
      "accessPass": [
        {
          "@type": "ImageObject",
          "url": "https://via.placeholder.com/25x25/cccccc/9c9c9c.png"
        },
        {
          "@type": "Barcode",
          "text": "7507865356",
          "url": "https://via.placeholder.com/25x25/cccccc/9c9c9c.png",
          "beta:codeType": "code128"
        }
      ],
      "orderedItem": {
        "@type": "ScheduledSession",
        "@id": "https://localhost:5001/api/identifiers/scheduled-sessions/2408/events/20408",
        "startDate": "2022-07-23T10:43:34+00:00",
        "endDate": "2022-07-23T11:43:34+00:00",
        "superEvent": {
          "@type": "SessionSeries",
          "@id": "https://localhost:5001/api/identifiers/session-series/2408",
          "name": "[OPEN BOOKING API TEST INTERFACE] Bookable Free Event",
          "activity": [
            {
              "@type": "Concept",
              "@id": "https://openactive.io/activity-list#6bdea630-ad22-4e58-98a3-bca26ee3f1da",
              "inScheme": "https://openactive.io/activity-list",
              "prefLabel": "Rave Fitness"
            }
          ],
          "location": {
            "@type": "Place",
            "name": "Fake fitness studio",
            "geo": {
              "@type": "GeoCoordinates",
              "latitude": 51.6201,
              "longitude": 0.302396
            }
          },
          "url": "https://example.com/events/2408"
        },
        "maximumAttendeeCapacity": 10,
        "remainingAttendeeCapacity": 10
      },
      "orderItemStatus": "https://openactive.io/OrderItemConfirmed",
      "unitTaxSpecification": [
        {
          "@type": "TaxChargeSpecification",
          "name": "VAT at 20%",
          "price": 0,
          "priceCurrency": "GBP",
          "rate": 0.2
        }
      ]
    }
  ],
  "seller": {
    "@type": "Organization",
    "@id": "https://localhost:5001/api/identifiers/sellers/1",
    "name": "Acme Fitness Ltd",
    "address": {
      "@type": "PostalAddress",
      "addressCountry": "GB",
      "addressLocality": "Another town",
      "addressRegion": "Oxfordshire",
      "postalCode": "OX1 1AA",
      "streetAddress": "1 Hidden Gem"
    },
    "isOpenBookingAllowed": true,
    "legalName": "Acme Fitness Ltd",
    "taxMode": "https://openactive.io/TaxGross",
    "termsOfService": [
      {
        "@type": "PrivacyPolicy",
        "name": "Privacy Policy",
        "requiresExplicitConsent": false,
        "url": "https://example.com/privacy.html"
      }
    ]
  },
  "totalPaymentDue": {
    "@type": "PriceSpecification",
    "openBookingPrepayment": "https://openactive.io/Unavailable",
    "price": 0,
    "priceCurrency": "GBP"
  },
  "totalPaymentTax": [
    {
      "@type": "TaxChargeSpecification",
      "name": "VAT at 20%",
      "price": 0,
      "priceCurrency": "GBP",
      "rate": 0.2
    }
  ]
}
```
### Specs
* âœ… should return 201 on success

## B >> validation of B
### Specs
* âœ… passes validation checks

### Validations
 * âš ï¸ $.orderedItem[0].accessChannel: Recommended property `accessChannel` is missing from `OrderItem`.
 * âš ï¸ $.orderedItem[0].acceptedOffer.name: Recommended property `name` is missing from `Offer`.
 * âš ï¸ $.orderedItem[0].acceptedOffer.ageRestriction: Recommended property `ageRestriction` is missing from `Offer`.
 * âš ï¸ $.orderedItem[0].orderedItem.eventStatus: Recommended property `eventStatus` is missing from `ScheduledSession`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.ageRange: Recommended property `ageRange` is missing from `SessionSeries`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.genderRestriction: Recommended property `genderRestriction` is missing from `SessionSeries`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.eventStatus: Recommended property `eventStatus` is missing from `SessionSeries`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.id: Recommended property `@id` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.url: Recommended property `url` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.description: Recommended property `description` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.image: Recommended property `image` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.telephone: Recommended property `telephone` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.openingHoursSpecification: Recommended property `openingHoursSpecification` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.amenityFeature: Recommended property `amenityFeature` is missing from `Place`.
 * âš ï¸ $.seller.email: Recommended property `email` is missing from `Organization`.
 * âš ï¸ $.seller.url: Recommended property `url` is missing from `Organization`.
 * âš ï¸ $.seller.logo: Recommended property `logo` is missing from `Organization`.
 * âš ï¸ $.seller.vatID: Recommended property `vatID` is missing from `Organization`.
 * ðŸ“ $.orderedItem[0].orderedItem.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `ScheduledSession`.
 * ðŸ“ $.orderedItem[0].orderedItem.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.orderedItem[0].orderedItem.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.
 * ðŸ“ $.orderedItem[0].orderedItem.superEvent.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `SessionSeries`.
 * ðŸ“ $.orderedItem[0].orderedItem.superEvent.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.orderedItem[0].orderedItem.superEvent.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.

## OrderProposal Feed Deletion (after B)

### Orders (order-proposals) Feed collect for &#x27;ebd87359-8e25-41db-9895-639a04052db2&#x27; change (auth: primary) Request
GET http://localhost:3000/order-listeners/order-proposals/primary/ebd87359-8e25-41db-9895-639a04052db2


---
Response status code: 200 OK. Responded in 883.138793ms.
```json
{
  "state": "deleted",
  "kind": "Order",
  "id": "ebd87359-8e25-41db-9895-639a04052db2",
  "modified": 637940834180015500
}
```
### Specs
* âœ… should return 200 on success

## OrderProposal Feed Deletion (after B) >> validation of OrderFeed
### Specs
* âœ… passes validation checks

### Validations

## Assert Opportunity Capacity (after OrderProposal Feed Deletion (after B))

### Opportunity Feed extract for OrderItem 0 Request
GET http://localhost:3000/opportunity/https%3A%2F%2Flocalhost%3A5001%2Fapi%2Fidentifiers%2Fscheduled-sessions%2F2408%2Fevents%2F20408?useCacheIfAvailable=true&expectedCapacity=9


---
Response status code: 200 OK. Responded in 8.433275ms.
```json
{
  "data": {
    "@context": [
      "https://openactive.io/"
    ],
    "@type": "ScheduledSession",
    "@id": "https://localhost:5001/api/identifiers/scheduled-sessions/2408/events/20408",
    "startDate": "2022-07-23T10:43:34+00:00",
    "endDate": "2022-07-23T11:43:34+00:00",
    "superEvent": {
      "@type": "SessionSeries",
      "@id": "https://localhost:5001/api/identifiers/session-series/2408",
      "name": "[OPEN BOOKING API TEST INTERFACE] Bookable Free Event",
      "activity": [
        {
          "@type": "Concept",
          "@id": "https://openactive.io/activity-list#c07d63a0-8eb9-4602-8bcc-23be6deb8f83",
          "inScheme": "https://openactive.io/activity-list",
          "prefLabel": "Jet Skiing"
        }
      ],
      "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
      "location": {
        "@type": "Place",
        "name": "Fake Pond",
        "address": {
          "@type": "PostalAddress",
          "addressCountry": "GB",
          "addressLocality": "Another town",
          "addressRegion": "Oxfordshire",
          "postalCode": "OX1 1AA",
          "streetAddress": "1 Fake Park"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": 0.1,
          "longitude": 0.1
        }
      },
      "offers": [
        {
          "@type": "Offer",
          "@id": "https://localhost:5001/api/identifiers/session-series/2408#/offers/0",
          "allowCustomerCancellationFullRefund": true,
          "openBookingFlowRequirement": [
            "https://openactive.io/OpenBookingApproval"
          ],
          "price": 0,
          "priceCurrency": "GBP"
        }
      ],
      "organizer": {
        "@type": "Organization",
        "@id": "https://localhost:5001/api/identifiers/sellers/1",
        "name": "Acme Fitness Ltd",
        "isOpenBookingAllowed": true,
        "taxMode": "https://openactive.io/TaxGross",
        "termsOfService": [
          {
            "@type": "PrivacyPolicy",
            "name": "Privacy Policy",
            "requiresExplicitConsent": false,
            "url": "https://example.com/privacy.html"
          }
        ]
      },
      "url": "https://www.example.com/a-session-age"
    },
    "duration": "PT1H",
    "maximumAttendeeCapacity": 10,
    "remainingAttendeeCapacity": 9
  }
}
```
### Specs
* âœ… should return 200 on success for request relevant to OrderItem 0

## Assert Opportunity Capacity (after OrderProposal Feed Deletion (after B)) >> validation of Opportunity Feed extract for OrderItem 0
### Specs
* âœ… passes validation checks

### Validations
 * âš ï¸ $.eventStatus: Recommended property `eventStatus` is missing from `ScheduledSession`.
 * âš ï¸ $.leader: Recommended property `leader` is missing from `ScheduledSession`.
 * âš ï¸ $.url: Recommended property `url` is missing from `ScheduledSession`.
 * âš ï¸ $.isAccessibleForFree: Where a `ScheduledSession` has at least one `Offer` with `price` set to `0`, it should also have a property named `isAccessibleForFree` set to `true`.
 * âš ï¸ $.superEvent.description: Recommended property `description` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.image: Recommended property `image` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.ageRange: Recommended property `ageRange` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.genderRestriction: Recommended property `genderRestriction` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.leader: Recommended property `leader` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.level: Recommended property `level` is missing from `SessionSeries`.
 * âš ï¸ $.superEvent.isAccessibleForFree: Where a `SessionSeries` has at least one `Offer` with `price` set to `0`, it should also have a property named `isAccessibleForFree` set to `true`.
 * âš ï¸ $.superEvent.location.id: Recommended property `@id` is missing from `Place`.
 * âš ï¸ $.superEvent.location.url: Recommended property `url` is missing from `Place`.
 * âš ï¸ $.superEvent.location.description: Recommended property `description` is missing from `Place`.
 * âš ï¸ $.superEvent.location.image: Recommended property `image` is missing from `Place`.
 * âš ï¸ $.superEvent.location.telephone: Recommended property `telephone` is missing from `Place`.
 * âš ï¸ $.superEvent.location.openingHoursSpecification: Recommended property `openingHoursSpecification` is missing from `Place`.
 * âš ï¸ $.superEvent.location.amenityFeature: Recommended property `amenityFeature` is missing from `Place`.
 * âš ï¸ $.superEvent.offers[0].name: Recommended property `name` is missing from `Offer`.
 * âš ï¸ $.superEvent.offers[0].ageRestriction: Recommended property `ageRestriction` is missing from `Offer`.
 * âš ï¸ $.superEvent.organizer.url: Recommended property `url` is missing from `Organization`.
 * âš ï¸ $.superEvent.organizer.telephone: Recommended property `telephone` is missing from `Organization`.
 * âš ï¸ $.superEvent.organizer.sameAs: Recommended property `sameAs` is missing from `Organization`.
 * ðŸ“ $.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `ScheduledSession`.
 * ðŸ“ $.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.
 * ðŸ“ $.superEvent.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `SessionSeries`.
 * ðŸ“ $.superEvent.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.superEvent.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.
 * ðŸ“ $.superEvent.location.geo.latitude: The value of this property should have at least 3 decimal places. Note that this notice will also appear when trailing zeros have been truncated.
 * ðŸ“ $.superEvent.location.geo.longitude: The value of this property should have at least 3 decimal places. Note that this notice will also appear when trailing zeros have been truncated.

## idempotent repeat B >> B

### B Request
PUT https://localhost:5001/api/openbooking/orders/ebd87359-8e25-41db-9895-639a04052db2

* **Content-Type:** `"application/vnd.openactive.booking+json; version=1"`
* **Authorization:** `"Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkIwNEY3QjkxREUzQjk0NzhDNjE4MzNGQjI0QUE1Q0RCIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE2NTg0ODU2NTAsImV4cCI6MTY1ODQ4OTI1MCwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMyIsImF1ZCI6Im9wZW5ib29raW5nIiwiY2xpZW50X2lkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0IiwiaHR0cHM6Ly9vcGVuYWN0aXZlLmlvL2NsaWVudElkIjoiNjJiNGY3MmUtZmJmOS00OTk0LTlkNDQtYmQ5NTMwOTllMTM0Iiwic3ViIjoiMTAwIiwiYXV0aF90aW1lIjoxNjU4NDg1NjQ5LCJpZHAiOiJsb2NhbCIsImh0dHBzOi8vb3BlbmFjdGl2ZS5pby9zZWxsZXJJZCI6Imh0dHBzOi8vbG9jYWxob3N0OjUwMDEvYXBpL2lkZW50aWZpZXJzL3NlbGxlcnMvMSIsImp0aSI6IkZFNjE5OTM5Q0M2MUVFRTFDQTFDRUIyNzczMTYyMjg5Iiwic2lkIjoiMEI1RjVGRDEzODJGNTY2REE2NzI2RUM1RjBENjRFQ0QiLCJpYXQiOjE2NTg0ODU2NTAsInNjb3BlIjpbIm9wZW5pZCIsIm9wZW5hY3RpdmUtb3BlbmJvb2tpbmciLCJvcGVuYWN0aXZlLWlkZW50aXR5Iiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbInB3ZCJdfQ.o-QctzkQMggVF6J8EIsjxJ43llGhs2jSEGiCfZxoPJjg0Coj1XkqaKd5Bltzc2D21dEBtbq-c5sKreCqebPhxuDlg_pDikudK9_wCosxWyOPIBS3OX6HFWM-J-Ofpxgkk5thfLTkLlDW8N6f3jtsTIRGm9dZvKsGypmwxnDdRhGKwxSDhnabWbPtFCABWC6DxK5mgb6V5SX3W3QxbI181T1tQioKui-N8j1FSgIpXrE3qy2ShkI-QbxwmMBCYhqcTbhLi41SUSx6gKgtl54lc_JEx-kSBlgsQmOrRKMDDrEecM9JQMNAliL2mJeIClUfC8k_SUKbJ8VvbNBbMjVSCw"`

```json
{
  "@context": "https://openactive.io/",
  "@type": "Order",
  "orderProposalVersion": "https://localhost:5001/api/openbooking/order-proposals/ebd87359-8e25-41db-9895-639a04052db2/versions/d3c74563-d468-4fcf-ba73-f3b737adebe3"
}
```

---
Response status code: 201 Created. Responded in 65.74888ms.
```json
{
  "@context": [
    "https://openactive.io/",
    "https://openactive.io/ns-beta"
  ],
  "@type": "Order",
  "@id": "https://localhost:5001/api/openbooking/orders/ebd87359-8e25-41db-9895-639a04052db2",
  "identifier": "ebd87359-8e25-41db-9895-639a04052db2",
  "bookingService": {
    "@type": "BookingService",
    "name": "Acme booking system",
    "termsOfService": [
      {
        "@type": "PrivacyPolicy",
        "name": "Privacy Policy",
        "requiresExplicitConsent": false,
        "url": "https://example.com/privacy.html"
      }
    ],
    "url": "https://example.com"
  },
  "broker": {
    "@type": "Organization",
    "name": "MyFitnessApp",
    "url": "https://myfitnessapp.example.com/"
  },
  "brokerRole": "https://openactive.io/AgentBroker",
  "customer": {
    "@type": "Person",
    "identifier": "fea89cd8-81f1-434b-b0e9-5a6d3486a96f",
    "email": "Gillian_Glover60@hotmail.com",
    "familyName": "Juliana",
    "givenName": "Huels",
    "telephone": "1-927-812-0052"
  },
  "orderedItem": [
    {
      "@type": "OrderItem",
      "@id": "https://localhost:5001/api/openbooking/orders/ebd87359-8e25-41db-9895-639a04052db2#/orderedItems/2024",
      "acceptedOffer": {
        "@type": "Offer",
        "@id": "https://localhost:5001/api/identifiers/session-series/2408#/offers/0",
        "allowCustomerCancellationFullRefund": true,
        "price": 0,
        "priceCurrency": "GBP"
      },
      "accessCode": [
        {
          "@type": "PropertyValue",
          "name": "Pin Code",
          "description": "027058",
          "value": "defaultValue"
        }
      ],
      "accessPass": [
        {
          "@type": "ImageObject",
          "url": "https://via.placeholder.com/25x25/cccccc/9c9c9c.png"
        },
        {
          "@type": "Barcode",
          "text": "7507865356",
          "url": "https://via.placeholder.com/25x25/cccccc/9c9c9c.png",
          "beta:codeType": "code128"
        }
      ],
      "orderedItem": {
        "@type": "ScheduledSession",
        "@id": "https://localhost:5001/api/identifiers/scheduled-sessions/2408/events/20408",
        "startDate": "2022-07-23T10:43:34+00:00",
        "endDate": "2022-07-23T11:43:34+00:00",
        "superEvent": {
          "@type": "SessionSeries",
          "@id": "https://localhost:5001/api/identifiers/session-series/2408",
          "name": "[OPEN BOOKING API TEST INTERFACE] Bookable Free Event",
          "activity": [
            {
              "@type": "Concept",
              "@id": "https://openactive.io/activity-list#6bdea630-ad22-4e58-98a3-bca26ee3f1da",
              "inScheme": "https://openactive.io/activity-list",
              "prefLabel": "Rave Fitness"
            }
          ],
          "location": {
            "@type": "Place",
            "name": "Fake fitness studio",
            "geo": {
              "@type": "GeoCoordinates",
              "latitude": 51.6201,
              "longitude": 0.302396
            }
          },
          "url": "https://example.com/events/2408"
        },
        "maximumAttendeeCapacity": 10,
        "remainingAttendeeCapacity": 10
      },
      "orderItemStatus": "https://openactive.io/OrderItemConfirmed",
      "unitTaxSpecification": [
        {
          "@type": "TaxChargeSpecification",
          "name": "VAT at 20%",
          "price": 0,
          "priceCurrency": "GBP",
          "rate": 0.2
        }
      ]
    }
  ],
  "seller": {
    "@type": "Organization",
    "@id": "https://localhost:5001/api/identifiers/sellers/1",
    "name": "Acme Fitness Ltd",
    "address": {
      "@type": "PostalAddress",
      "addressCountry": "GB",
      "addressLocality": "Another town",
      "addressRegion": "Oxfordshire",
      "postalCode": "OX1 1AA",
      "streetAddress": "1 Hidden Gem"
    },
    "isOpenBookingAllowed": true,
    "legalName": "Acme Fitness Ltd",
    "taxMode": "https://openactive.io/TaxGross",
    "termsOfService": [
      {
        "@type": "PrivacyPolicy",
        "name": "Privacy Policy",
        "requiresExplicitConsent": false,
        "url": "https://example.com/privacy.html"
      }
    ]
  },
  "totalPaymentDue": {
    "@type": "PriceSpecification",
    "openBookingPrepayment": "https://openactive.io/Unavailable",
    "price": 0,
    "priceCurrency": "GBP"
  },
  "totalPaymentTax": [
    {
      "@type": "TaxChargeSpecification",
      "name": "VAT at 20%",
      "price": 0,
      "priceCurrency": "GBP",
      "rate": 0.2
    }
  ]
}
```
### Specs
* âœ… should return 201 on success

## idempotent repeat B >> B >> validation of B
### Specs
* âœ… passes validation checks

### Validations
 * âš ï¸ $.orderedItem[0].accessChannel: Recommended property `accessChannel` is missing from `OrderItem`.
 * âš ï¸ $.orderedItem[0].acceptedOffer.name: Recommended property `name` is missing from `Offer`.
 * âš ï¸ $.orderedItem[0].acceptedOffer.ageRestriction: Recommended property `ageRestriction` is missing from `Offer`.
 * âš ï¸ $.orderedItem[0].orderedItem.eventStatus: Recommended property `eventStatus` is missing from `ScheduledSession`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.ageRange: Recommended property `ageRange` is missing from `SessionSeries`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.genderRestriction: Recommended property `genderRestriction` is missing from `SessionSeries`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.eventStatus: Recommended property `eventStatus` is missing from `SessionSeries`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.id: Recommended property `@id` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.url: Recommended property `url` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.description: Recommended property `description` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.image: Recommended property `image` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.telephone: Recommended property `telephone` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.openingHoursSpecification: Recommended property `openingHoursSpecification` is missing from `Place`.
 * âš ï¸ $.orderedItem[0].orderedItem.superEvent.location.amenityFeature: Recommended property `amenityFeature` is missing from `Place`.
 * âš ï¸ $.seller.email: Recommended property `email` is missing from `Organization`.
 * âš ï¸ $.seller.url: Recommended property `url` is missing from `Organization`.
 * âš ï¸ $.seller.logo: Recommended property `logo` is missing from `Organization`.
 * âš ï¸ $.seller.vatID: Recommended property `vatID` is missing from `Organization`.
 * ðŸ“ $.orderedItem[0].orderedItem.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `ScheduledSession`.
 * ðŸ“ $.orderedItem[0].orderedItem.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.orderedItem[0].orderedItem.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.
 * ðŸ“ $.orderedItem[0].orderedItem.superEvent.genderRestriction: Data consumers will assume that there is no gender restriction when no valid `genderRestriction` is supplied on a `SessionSeries`.
 * ðŸ“ $.orderedItem[0].orderedItem.superEvent.ageRange: Data consumers will assume that the `ageRange` is 18+ when not specified.
 * ðŸ“ $.orderedItem[0].orderedItem.superEvent.eventStatus: Data consumers will assume the `eventStatus` is scheduled if not specified or invalid.


